library(dplyr)
studyarea <- shapefile('../data/study_area.shp')
studyarea <- shapefile('./data/study_area.shp')
targetdir = paste(getwd(),'oscillayer', sep='/')
targetdir = paste(getwd(),'work/oscillayer', sep='/')
library(raster)
library(dplyr)
library(readxl)
library(readr)
# Variables
studyarea <- shapefile('./data/study_area.shp')
zipfile <- 'C:/cs/geodata/Oscillayers/INPUT.zip' # Link to the oscillayers dataset
timeslices <- read_excel("./data/timeslices.xlsx")
scaling_factors <- unzip(zipfile, files='Scaling_factor_TabS1.csv') %>%
read_csv(locale = locale(encoding = "ISO-8859-1")) %>%
rename() %>% rename(age=1,Oscillayer=2,TS=3,sealevel=4,temperature=5,scaling_factor=6)
timeslices <- timeslices %>% left_join(scaling_factors)
## Load and clip bathymetric DEM
dem <- unzip(zipfile, files='ETOPO1_res.asc') %>%
raster() %>%
crop(studyarea)
crs(dem) <- '+init=epsg:4326'
## Load and clip bathymetric DEM
dem <- unzip(zipfile, files='ETOPO1_res.asc') %>%
raster() %>%
crop(studyarea)
crs(dem) <- '+init=epsg:4326'
sealevels <- timeslices %>% group_by(MIS) %>% summarise(msealevel=mean(sealevel))
library(tidyverse)
library(dismo)
library(ENMeval) #v2.0.0
set.seed(31)
covariates <- c('x','y','bio1','bio2','bio7','bio12','bio15','elev')  # Covariates selected in script 1.2_covariates_selection
maxent_eval <- readRDS('./work/maxent_model_selection/maxent_eval.RDS')
# plot model evalutaion
library(RColorBrewer)
evaldata <- maxent_eval@results %>% pivot_longer(-c(fc:tune.args), names_to='criterion', values_to='val') %>%
filter(criterion %in% c('delta.AICc','or.10p.avg','auc.val.avg')) %>%
mutate(fc=factor(fc, levels=c('L','LQ','LQH', 'LQP', 'LQHP', 'LQHPT')),
rm=as.numeric(as.character(rm)),
criterion=factor(criterion, levels=c('delta.AICc','or.10p.avg','auc.val.avg'), labels=c('Delta AICc','OR .10','AUC test')))
evalplot <- ggplot(data=evaldata, aes(x=rm, y=val, group=fc, color=fc))+
geom_vline(xintercept=1, linetype='dashed')+
geom_point()+
geom_line()+
facet_wrap(~criterion,
scales='free_y',
strip.position ='top')+
labs(x='Regularization multiplier', y='', color='Feature class')+
scale_x_continuous(limits=c(0,4))+
scale_color_brewer(palette = "Dark2")+
theme_bw()+
theme(
strip.text = element_text(size = rel(1)),
strip.background = element_rect(fill = NA, colour = 'black', size = 0.4)
)
plot(evalplot)
svg("./results/fig_model_evaluation.svg", units="cm", width=19, height=6)
evalplot
dev.off()
dev.off()
svg("./results/fig_model_evaluation.svg", units="cm", width=19, height=6)
evalplot
dev.off()
svg("./results/fig_model_evaluation.svg", width=19, height=6)
evalplot
dev.off()
eps("./results/fig_model_evaluation.eps", width=18.3, height=6)
evalplot
dev.off()
install.packages("R.utils")
library(r:utils)
library(R.utils)
eps("./results/fig_model_evaluation.eps", width=18.3, height=6)
evalplot
dev.off()
ggsave("./results/fig_model_evaluation.eps", units="cm", width=18.3, height=6, dpi=600)
evalplot
ggsave("./results/fig_model_evaluation.eps", units="cm", width=18.3, height=6, dpi=600)
library(tidyverse)
library(dismo)
library(cowplot)
maxent_model <- readRDS('./work/maxent_model_selection/maxent_eval_select.RDS')
## Plot sample and background densities (A)
model_data <- bind_rows('Presence'=maxent_model@presence, 'Background'=maxent_model@absence, .id='type') %>% pivot_longer(-c(type), names_to = 'feature')
model_data$feature <- model_data$feature  %>% recode_factor(bio12='BIO12',bio15='BIO15',bio1='BIO1',bio2='BIO2', elev='Elevation', bio7='BIO7')
plt_dens <- ggplot(data=model_data, aes(x=value, fill=type))+
geom_density(alpha=0.6)+
facet_wrap(.~feature, scales='free', nrow=1)+
scale_fill_manual(values=c('grey','red'))+
labs(x='', y="Density", fill='')+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'),
strip.text = element_text(size = rel(1)),
strip.background = element_rect(fill = NA, colour = 'black', size = 0.4))
plot(plt_dens)
## Plot feature importance (C)
View(maxent_model@results)  # Just copy-paste the values because this list is difficult to transform
feature_importance <- data.frame(feature=factor(c('BIO1', 'BIO15', 'BIO12','BIO7','BIO2', 'Elevation','BIO1', 'BIO15', 'BIO12','BIO7','BIO2', 'Elevation'), levels=c('BIO12', 'BIO15', 'BIO1','BIO2', 'Elevation','BIO7'),ordered = T),
indicator=c('contribution', 'contribution', 'contribution', 'contribution','contribution', 'contribution', 'permutation importance', 'permutation importance', 'permutation importance', 'permutation importance', 'permutation importance', 'permutation importance'),
value=c(35.2479,29.4679,22.3875,7.7451,4.2089,0.9427,23.2646,23.7045,34.5552,3.6263,10.6631,4.1863)
)
plt_feature_importance <- ggplot(data=feature_importance, aes(x=feature, y=value, fill=indicator))+
geom_bar(stat='identity', position=position_dodge())+
geom_text(aes(label=round(value)), vjust=0.5, hjust=1.1, color="black",
position = position_dodge(0.9), size=2)+
scale_fill_manual(values=c('#eab676','#76b5c5'))+
labs(x='Feature', y="Percentage", fill='Measure')+
scale_x_discrete(limits = rev(levels(feature_importance$feature)))+
coord_flip()+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'))
plot(plt_feature_importance)
plt_feature_importance <- ggplot(data=feature_importance, aes(x=feature, y=value, fill=indicator))+
geom_bar(stat='identity', position=position_dodge())+
geom_text(aes(label=round(value)), vjust=0.5, hjust=1.1, color="black",
position = position_dodge(0.9), size=2)+
scale_fill_manual(names=c('A', 'B'),
values=c('#eab676','#76b5c5'))+
labs(x='Feature', y="Percentage", fill='Measure')+
scale_x_discrete(limits = rev(levels(feature_importance$feature)))+
coord_flip()+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'))
plot(plt_feature_importance)
library(tidyverse)
library(dismo)
library(cowplot)
maxent_model <- readRDS('./work/maxent_model_selection/maxent_eval_select.RDS')
## Plot sample and background densities (A)
model_data <- bind_rows('Presence'=maxent_model@presence, 'Background'=maxent_model@absence, .id='type') %>% pivot_longer(-c(type), names_to = 'feature')
model_data$feature <- model_data$feature  %>% recode_factor(bio12='BIO12',bio15='BIO15',bio1='BIO1',bio2='BIO2', elev='Elevation', bio7='BIO7')
plt_dens <- ggplot(data=model_data, aes(x=value, fill=type))+
geom_density(alpha=0.6)+
facet_wrap(.~feature, scales='free', nrow=1)+
scale_fill_manual(values=c('grey','red'))+
labs(x='', y="Density", fill='')+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'),
strip.text = element_text(size = rel(1)),
strip.background = element_rect(fill = NA, colour = 'black', size = 0.4))
plot(plt_dens)
## Plot feature importance (C)
View(maxent_model@results)  # Just copy-paste the values because this list is difficult to transform
feature_importance <- data.frame(feature=factor(c('BIO1', 'BIO15', 'BIO12','BIO7','BIO2', 'Elevation','BIO1', 'BIO15', 'BIO12','BIO7','BIO2', 'Elevation'), levels=c('BIO12', 'BIO15', 'BIO1','BIO2', 'Elevation','BIO7'),ordered = T),
indicator=c('contribution', 'contribution', 'contribution', 'contribution','contribution', 'contribution', 'permutation importance', 'permutation importance', 'permutation importance', 'permutation importance', 'permutation importance', 'permutation importance'),
value=c(35.2479,29.4679,22.3875,7.7451,4.2089,0.9427,23.2646,23.7045,34.5552,3.6263,10.6631,4.1863)
)
plt_feature_importance <- ggplot(data=feature_importance, aes(x=feature, y=value, fill=indicator))+
geom_bar(stat='identity', position=position_dodge())+
geom_text(aes(label=round(value)), vjust=0.5, hjust=1.1, color="black",
position = position_dodge(0.9), size=2)+
scale_fill_manual(values=c('#eab676','#76b5c5'))+
labs(x='Feature', y="Percentage", fill='Measure')+
scale_x_discrete(limits = rev(levels(feature_importance$feature)))+
coord_flip()+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'))
plot(plt_feature_importance)
plt_feature_importance <- ggplot(data=feature_importance, aes(x=feature, y=value, fill=indicator))+
geom_bar(stat='identity', position=position_dodge())+
geom_text(aes(label=round(value)), vjust=0.5, hjust=1.1, color="black",
position = position_dodge(0.9), size=2)+
scale_fill_manual(labels=c(1,2),
values=c('#eab676','#76b5c5'))+
labs(x='Feature', y="Percentage", fill='Measure')+
scale_x_discrete(limits = rev(levels(feature_importance$feature)))+
coord_flip()+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'))
plot(plt_feature_importance)
plt_feature_importance <- ggplot(data=feature_importance, aes(x=feature, y=value, fill=indicator))+
geom_bar(stat='identity', position=position_dodge())+
geom_text(aes(label=round(value)), vjust=0.5, hjust=1.1, color="black",
position = position_dodge(0.9), size=2)+
scale_fill_manual(limits=c('permutation importance','contribution'),
values=c('#eab676','#76b5c5'))+
labs(x='Feature', y="Percentage", fill='Measure')+
scale_x_discrete(limits = rev(levels(feature_importance$feature)))+
coord_flip()+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'))
plot(plt_feature_importance)
plt_feature_importance <- ggplot(data=feature_importance, aes(x=feature, y=value, fill=indicator))+
geom_bar(stat='identity', position=position_dodge())+
geom_text(aes(label=round(value)), vjust=0.5, hjust=1.1, color="black",
position = position_dodge(0.9), size=2)+
scale_fill_manual(limits=c('permutation importance','contribution'),
values=c('#76b5c5','#eab676'))+
labs(x='Feature', y="Percentage", fill='Measure')+
scale_x_discrete(limits = rev(levels(feature_importance$feature)))+
coord_flip()+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'))
plot(plt_feature_importance)
## Combine C with free space for B
bottom_row <- plot_grid(
NA, plt_feature_importance,
labels = c('b', 'c'), rel_widths = c(1, 1.5), label_size = 7
)
plot(bottom_row)
plot_grid(plt_dens, bottom_row, labels = c('a', ''), label_size = 7, ncol = 1, rel_heights = c(0.75,1))
ggsave("./results/fig_model_performance/fig_model_performance.eps", units="cm", width=18.3, height=6, dpi=600)
ggsave("./results/fig_model_performance/fig_model_performance.eps", units="cm", width=18.3, height=10, dpi=600)
plt_feature_importance <- ggplot(data=feature_importance, aes(x=feature, y=value, fill=indicator))+
geom_bar(stat='identity', position=position_dodge())+
geom_text(aes(label=round(value)), vjust=0.5, hjust=1.1, color="black",
position = position_dodge(0.9), size=2)+
scale_fill_manual(limits=c('permutation importance','contribution'),
values=c('#76b5c5','#eab676'))+
labs(x='Feature', y="Percentage", fill='Measure')+
scale_x_discrete(limits = rev(levels(feature_importance$feature)))+
coord_flip()+
#theme_cowplot(font_size = 7, font_family = 'sans')+
#theme(text = element_text(size = 7, family='sans'))
theme_cowplot(font_size = 7)+
theme(text = element_text(size = 7))
plot(plt_feature_importance)
## Combine C with free space for B
bottom_row <- plot_grid(
NA, plt_feature_importance,
labels = c('b', 'c'), rel_widths = c(1, 1.5), label_size = 7
)
plot(bottom_row)
plot_grid(plt_dens, bottom_row, labels = c('a', ''), label_size = 7, ncol = 1, rel_heights = c(0.75,1))
ggsave("./results/fig_model_performance/fig_model_performance.eps", units="cm", width=18.3, height=10, dpi=600)
plt_dens <- ggplot(data=model_data, aes(x=value, fill=type))+
geom_density(alpha=0.6)+
facet_wrap(.~feature, scales='free', nrow=1)+
scale_fill_manual(values=c('grey','red'))+
labs(x='', y="Density", fill='')+
#theme_cowplot(font_size = 7, font_family = 'sans')+
#theme(text = element_text(size = 7, family='sans'),
theme_cowplot(font_size = 7)+
theme(text = element_text(size = 7),
strip.text = element_text(size = rel(1)),
strip.background = element_rect(fill = NA, colour = 'black', size = 0.4))
plot(plt_dens)
## Combine C with free space for B
bottom_row <- plot_grid(
NA, plt_feature_importance,
labels = c('b', 'c'), rel_widths = c(1, 1.5), label_size = 7
)
plot(bottom_row)
plot_grid(plt_dens, bottom_row, labels = c('a', ''), label_size = 7, ncol = 1, rel_heights = c(0.75,1))
ggsave("./results/fig_model_performance/fig_model_performance.eps", units="cm", width=18.3, height=10, dpi=600)
plt_feature_importance <- ggplot(data=feature_importance, aes(x=feature, y=value, fill=indicator))+
geom_bar(stat='identity', position=position_dodge())+
geom_text(aes(label=round(value)), vjust=0.5, hjust=1.1, color="black",
position = position_dodge(0.9), size=2)+
scale_fill_manual(limits=c('permutation importance','contribution'),
values=c('#76b5c5','#eab676'))+
labs(x='Feature', y="Percentage", fill='Measure')+
scale_x_discrete(limits = rev(levels(feature_importance$feature)))+
coord_flip()+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'))
plot(plt_feature_importance)
plt_dens <- ggplot(data=model_data, aes(x=value, fill=type))+
geom_density(alpha=0.6)+
facet_wrap(.~feature, scales='free', nrow=1)+
scale_fill_manual(values=c('grey','red'))+
labs(x='', y="Density", fill='')+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'),
strip.text = element_text(size = rel(1)),
strip.background = element_rect(fill = NA, colour = 'black', size = 0.4))
plot(plt_dens)
plt_feature_importance <- ggplot(data=feature_importance, aes(x=feature, y=value, fill=indicator))+
geom_bar(stat='identity', position=position_dodge())+
geom_text(aes(label=round(value)), vjust=0.5, hjust=1.1, color="black",
position = position_dodge(0.9), size=2)+
scale_fill_manual(limits=c('permutation importance','contribution'),
values=c('#76b5c5','#eab676'))+
labs(x='Feature', y="Percentage", fill='Measure')+
scale_x_discrete(limits = rev(levels(feature_importance$feature)))+
coord_flip()+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'))
plot(plt_feature_importance)
## Combine C with free space for B
bottom_row <- plot_grid(
NA, plt_feature_importance,
labels = c('b', 'c'), rel_widths = c(1, 1.5), label_size = 7
)
plot(bottom_row)
## Export panel leaving free space for B
tiff("./results/fig_model_performance/fig_model_performance.tiff", units="cm", width=18.3, height=10, res=600)
plot_grid(plt_dens, bottom_row, labels = c('a', ''), label_size = 7, ncol = 1, rel_heights = c(0.75,1))
dev.off()
# Scatterplot (B) to be added with a graphics program
library(plot3D)
presence_points <- maxent_model@presence
absence_points <- maxent_model@absence
#svg("fig_3dscatter.svg", width=7.32, height=5.71, pointsize=7)
#tiff("fig_3dscatter.tiff", units="px", width=1729, height=1181, pointsize = 7, res=600)
par(mar = c(0, 0, 0, 0))
plt_scatter <- scatter3D(x=absence_points$bio12, y=absence_points$bio15, z=absence_points$bio1,
col = 'black',
pch = 20,
cex = 0.15,
colkey = FALSE,
bty = "b2",
ticktype = "detailed",
#xlab = 'BIO12', ylab='BIO7',zlab = "BIO15",
xlab = '', ylab='',zlab = "",
cex.lab=1, cex.axis=1, line=2,
alpha=.2)
plt_scatter <- scatter3D(x=presence_points$bio12, y=presence_points$bio15, z=presence_points$bio1,
col = 'red',
pch = 20,0,
cex = 0.15,
add = TRUE)
tiff("./results/fig_model_performance/fig_3dscatter.tiff", units="cm", width=7.32, height=5.71, res=600, pointsize=7)
par(mar = c(0, 0, 0, 0))
plt_scatter <- scatter3D(x=absence_points$bio12, y=absence_points$bio15, z=absence_points$bio1,
col = 'black',
pch = 20,
cex = 0.15,
colkey = FALSE,
bty = "b2",
ticktype = "detailed",
#xlab = 'BIO12', ylab='BIO7',zlab = "BIO15",
xlab = '', ylab='',zlab = "",
cex.lab=1, cex.axis=1, line=2,
alpha=.2)
plt_scatter <- scatter3D(x=presence_points$bio12, y=presence_points$bio15, z=presence_points$bio1,
col = 'red',
pch = 20,0,
cex = 0.15,
add = TRUE)
dev.off()
svg("./results/fig_model_performance/fig_3dscatter.svg", width=7.32, height=5.71, pointsize=7)
par(mar = c(0, 0, 0, 0))
plt_scatter <- scatter3D(x=absence_points$bio12, y=absence_points$bio15, z=absence_points$bio1,
col = 'black',
pch = 20,
cex = 0.15,
colkey = FALSE,
bty = "b2",
ticktype = "detailed",
#xlab = 'BIO12', ylab='BIO7',zlab = "BIO15",
xlab = '', ylab='',zlab = "",
cex.lab=1, cex.axis=1, line=2,
alpha=.2)
plt_scatter <- scatter3D(x=presence_points$bio12, y=presence_points$bio15, z=presence_points$bio1,
col = 'red',
pch = 20,0,
cex = 0.15,
add = TRUE)
dev.off()
svg("./results/fig_model_performance/fig_model_performance.svg", units="cm", width=18.3, height=10, res=600)
svg("./results/fig_model_performance/fig_model_performance.svg", width=18.3, height=10, pointsize = 7)
plot_grid(plt_dens, bottom_row, labels = c('a', ''), label_size = 7, ncol = 1, rel_heights = c(0.75,1))
dev.off()
svg("./results/fig_model_performance/fig_model_performance.svg", width=18.3, height=10)
plot_grid(plt_dens, bottom_row, labels = c('a', ''), label_size = 7, ncol = 1, rel_heights = c(0.75,1))
dev.off()
svg("./results/fig_model_performance/fig_model_performance.svg", width=18.3, height=10, pointsize = 7)
plot_grid(plt_dens, bottom_row, labels = c('a', ''), label_size = 7, ncol = 1, rel_heights = c(0.75,1))
dev.off()
plt_feature_importance <- ggplot(data=feature_importance, aes(x=feature, y=value, fill=indicator))+
geom_bar(stat='identity', position=position_dodge())+
geom_text(aes(label=round(value)), vjust=0.5, hjust=1.1, color="black",
position = position_dodge(0.9), size=2)+
scale_fill_manual(limits=c('Permutation importance','Contribution'),
values=c('#76b5c5','#eab676'))+
labs(x='Feature', y="Percentage", fill='Measure')+
scale_x_discrete(limits = rev(levels(feature_importance$feature)))+
coord_flip()+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'))
plot(plt_feature_importance)
plt_feature_importance <- ggplot(data=feature_importance, aes(x=feature, y=value, fill=indicator))+
geom_bar(stat='identity', position=position_dodge())+
geom_text(aes(label=round(value)), vjust=0.5, hjust=1.1, color="black",
position = position_dodge(0.9), size=2)+
scale_fill_manual(limits=c('permutation importance','contribution'),
labels=c('Permutation importance','Contribution'),
values=c('#76b5c5','#eab676'))+
labs(x='Feature', y="Percentage", fill='Measure')+
scale_x_discrete(limits = rev(levels(feature_importance$feature)))+
coord_flip()+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'))
plot(plt_feature_importance)
## Combine C with free space for B
bottom_row <- plot_grid(
NA, plt_feature_importance,
labels = c('b', 'c'), rel_widths = c(1, 1.5), label_size = 7
)
plot(bottom_row)
## Export panel leaving free space for B
tiff("./results/fig_model_performance/fig_model_performance.tiff", units="cm", width=18.3, height=10, res=600)
plot_grid(plt_dens, bottom_row, labels = c('a', ''), label_size = 7, ncol = 1, rel_heights = c(0.75,1))
dev.off()
plt_dens <- ggplot(data=model_data, aes(x=value, fill=type))+
geom_density(alpha=0.6)+
facet_wrap(.~feature, scales='free', nrow=1)+
scale_fill_manual(limits=c('Presence','Background'),
values=c('red','grey'))+
scale_fill_manual(values=c('grey','red'))+
labs(x='', y="Density", fill='')+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'),
strip.text = element_text(size = rel(1)),
strip.background = element_rect(fill = NA, colour = 'black', size = 0.4))
plot(plt_dens)
plt_dens <- ggplot(data=model_data, aes(x=value, fill=type))+
geom_density(alpha=0.6)+
facet_wrap(.~feature, scales='free', nrow=1)+
scale_fill_manual(limits=c('Presence','Background'),
values=c('red','grey'))+
#scale_fill_manual(values=c('grey','red'))+
labs(x='', y="Density", fill='')+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'),
strip.text = element_text(size = rel(1)),
strip.background = element_rect(fill = NA, colour = 'black', size = 0.4))
plot(plt_dens)
plt_dens <- ggplot(data=model_data, aes(x=value, fill=type))+
geom_density(alpha=0.6)+
facet_wrap(.~feature, scales='free', nrow=1)+
scale_fill_manual(limits=c('Presence','Background'),
values=c('red','grey'))+
labs(x='', y="Density", fill='')+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'),
strip.text = element_text(size = rel(1)),
strip.background = element_rect(fill = NA, colour = 'black', size = 0.4))
plot(plt_dens)
plt_feature_importance <- ggplot(data=feature_importance, aes(x=feature, y=value, fill=indicator))+
geom_bar(stat='identity', position=position_dodge())+
geom_text(aes(label=round(value)), vjust=0.5, hjust=1.1, color="black",
position = position_dodge(0.9), size=2)+
scale_fill_manual(limits=c('permutation importance','contribution'),
labels=c('Permutation importance','Contribution'),
values=c('#76b5c5','#eab676'))+
labs(x='Feature', y="Percentage", fill='Measure')+
scale_x_discrete(limits = rev(levels(feature_importance$feature)))+
coord_flip()+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'))
plot(plt_feature_importance)
## Combine C with free space for B
bottom_row <- plot_grid(
NA, plt_feature_importance,
labels = c('b', 'c'), rel_widths = c(1, 1.5), label_size = 7
)
plot(bottom_row)
plot_grid(plt_dens, bottom_row, labels = c('a', ''), label_size = 7, ncol = 1, rel_heights = c(0.75,1))
tiff("./results/fig_model_performance/fig_model_performance.tiff", units="cm", width=18.3, height=10, res=600)
plot_grid(plt_dens, bottom_row, labels = c('a', ''), label_size = 7, ncol = 1, rel_heights = c(0.75,1))
dev.off()
plt_dens <- ggplot(data=model_data, aes(x=value, fill=type))+
geom_density(alpha=0.6)+
facet_wrap(.~feature, scales='free', nrow=1)+
scale_fill_manual(limits=c('Presence','Background'),
values=c('red','grey'))+
labs(x='', y="Density", fill='')+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'),
strip.text = element_text(size = rel(1)),
strip.background = element_rect(fill = NA, colour = 'black', size = 0.4),
axis.text.x = element_text(angle = 90))
plot(plt_dens)
plt_dens <- ggplot(data=model_data, aes(x=value, fill=type))+
geom_density(alpha=0.6)+
facet_wrap(.~feature, scales='free', nrow=1)+
scale_fill_manual(limits=c('Presence','Background'),
values=c('red','grey'))+
labs(x='', y="Density", fill='')+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'),
strip.text = element_text(size = rel(1)),
strip.background = element_rect(fill = NA, colour = 'black', size = 0.4),
axis.text.x = element_text(angle = 45))
plot(plt_dens)
plt_dens <- ggplot(data=model_data, aes(x=value, fill=type))+
geom_density(alpha=0.6)+
facet_wrap(.~feature, scales='free', nrow=1)+
scale_fill_manual(limits=c('Presence','Background'),
values=c('red','grey'))+
labs(x='', y="Density", fill='')+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'),
strip.text = element_text(size = rel(1)),
strip.background = element_rect(fill = NA, colour = 'black', size = 0.4),
axis.text.x = element_text(angle = 30))
plot(plt_dens)
## Combine C with free space for B
bottom_row <- plot_grid(
NA, plt_feature_importance,
labels = c('b', 'c'), rel_widths = c(1, 1.5), label_size = 7
)
plot(bottom_row)
plot_grid(plt_dens, bottom_row, labels = c('a', ''), label_size = 7, ncol = 1, rel_heights = c(0.75,1))
plt_dens <- ggplot(data=model_data, aes(x=value, fill=type))+
geom_density(alpha=0.6)+
facet_wrap(.~feature, scales='free', nrow=1)+
scale_fill_manual(limits=c('Presence','Background'),
values=c('red','grey'))+
labs(x='', y="Density", fill='')+
theme_cowplot(font_size = 7, font_family = 'sans')+
theme(text = element_text(size = 7, family='sans'),
strip.text = element_text(size = rel(1)),
strip.background = element_rect(fill = NA, colour = 'black', size = 0.4))
plot(plt_dens)
plot_grid(plt_dens, bottom_row, labels = c('a', ''), label_size = 7, ncol = 1, rel_heights = c(0.75,1))
tiff("./results/fig_model_performance/fig_model_performance.tiff", units="cm", width=18.3, height=10, res=600)
plot_grid(plt_dens, bottom_row, labels = c('a', ''), label_size = 7, ncol = 1, rel_heights = c(0.75,1))
dev.off()
